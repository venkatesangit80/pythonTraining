import pandas as pd

# Sample DataFrame
data = {'column': ['prod', 'dev-int', 'test-uat-env', 'stage-env-main']}
df = pd.DataFrame(data)

# Function to extract the last but one value (or the only value if length is 1)
def extract_environment(value):
    parts = value.split('-')  # Split by '-'
    if len(parts) == 1:       # If only one part, return it
        return parts[0]
    else:                     # Otherwise, return the last but one part
        return parts[-2]

# Apply the function to the column
df['environment'] = df['column'].apply(extract_environment)

print(df)