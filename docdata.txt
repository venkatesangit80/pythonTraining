import xml.etree.ElementTree as ET
from datetime import datetime
import pandas as pd

# Step 1: Parse XML string
tree = ET.fromstring(xml_string)  # or ET.parse("file.xml") if from file

records = []

# Step 2: Traverse and extract values
for metric_data in tree.findall("metric-data"):
    path = metric_data.find("metricPath").text
    for mv in metric_data.find("metricValues").findall("metric-value"):
        timestamp = datetime.fromtimestamp(int(mv.find("startTimeInMillis").text) / 1000)
        value = mv.findtext("value")
        min_val = mv.findtext("min")
        max_val = mv.findtext("max")
        count = mv.findtext("count")

        records.append({
            "metric_path": path,
            "timestamp": timestamp,
            "value": float(value) if value else None,
            "min": float(min_val) if min_val else None,
            "max": float(max_val) if max_val else None,
            "count": int(count) if count else None
        })

# Step 3: Convert to DataFrame
df = pd.DataFrame(records)
print(df.head())